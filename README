# AutoSlideNetCheck Setup Guide

This guide provides a complete setup for running the **AutoSlideNetCheck** script on a Mac with a fresh installation of macOS Sequoia. This setup is ideal for an office or display device that should automatically log in, run a Google Slides presentation in full-screen mode, and check for internet connectivity.

## Requirements
- A Mac running macOS Sequoia.
- User account **"Office TV"** for the display machine.
- Google Chrome installed (assumed included in the JAMF profile).

---

## Installation

### 1. Run the Installation Script (Recommended)

To streamline the setup process, use the provided installation script. This script automates configuration steps like scheduling power on/off times, enabling auto-login, setting notifications, and adding the AutoSlideNetCheck script as a login item.

**Script:** [install_auto_slide.sh](install_auto_slide.sh)

#### Run the script:
1. Save the script on your Mac, naming it `install_auto_slide.sh`.
2. Make the script executable by opening a terminal and running:
   ```bash
   chmod +x install_auto_slide.sh
Run the script with sudo privileges:
bash
Copy code
sudo ./install_auto_slide.sh
The script will automatically:

Schedule power on/off for weekdays (7:30 AM on, 4:00 PM off).
Set up auto-login for the Office TV user.
Disable notifications and configure Do Not Disturb hours.
Add AutoSlideNetCheck as a login item.
Configure Energy Saver settings and lock certain System Preferences.
2. Manual Configuration Steps (In Case of Script Errors)
If any issues arise with the script, you can perform each configuration step manually. Below are detailed explanations of each step in the process.

Step 1: Set Scheduled Power On and Shutdown Times
Command:

bash
Copy code
sudo pmset repeat wakeorpoweron MTWRF 07:30:00 shutdown MTWRF 16:00:00
This command configures the Mac to automatically power on at 7:30 AM and shut down at 4:00 PM on weekdays (Monday through Friday).

Step 2: Enable Auto-Login for "Office TV" User
Enable auto-login to the Office TV user account to ensure that the presentation starts without manual login.

Command:

bash
Copy code
sudo defaults write /Library/Preferences/com.apple.loginwindow autoLoginUser "Office TV"
Step 3: Disable Notifications and Set Do Not Disturb
This disables all notifications to prevent interruptions during presentation mode.

Commands:

Enable Do Not Disturb:
bash
Copy code
defaults -currentHost write com.apple.notificationcenterui doNotDisturb -bool true
Set Do Not Disturb hours (e.g., 6 AM - 5 PM):
bash
Copy code
defaults write com.apple.ncprefs.plist dndStart -int 360  # 6 AM in minutes
defaults write com.apple.ncprefs.plist dndEnd -int 1020   # 5 PM in minutes
Restart NotificationCenter to apply changes:
bash
Copy code
killall NotificationCenter
Step 4: Add AutoSlideNetCheck Script to Login Items
Ensure that AutoSlideNetCheck runs at login by adding it as a login item.

Command:

bash
Copy code
osascript -e 'tell application "System Events" to make login item at end with properties {path:"/path/to/AutoSlideNetCheck.applescript", hidden:true}'
Replace /path/to/AutoSlideNetCheck.applescript with the actual path to the AutoSlideNetCheck script.

Step 5: Configure Energy Saver Settings
Prevent the Mac from sleeping during active hours, and set it to automatically restart after a power failure.

Commands:

#Set the display to never sleep:      sudo pmset -a displaysleep 0
Enable auto-restart after power failure:
bash
Copy code
sudo pmset -a autorestart 1
Prevent the Mac from sleeping when the display is off:
bash
Copy code
sudo pmset -a sleep 0
Step 6: Lock System Preferences for Security
Lock Accessibility and Privacy settings to prevent unauthorized changes.

Commands:

bash
Copy code
sudo security authorizationdb write system.preferences "allow"
sudo security authorizationdb write system.preferences.security "allow"
Final Step: Convert Office TV User to Standard
After configuration, convert the Office TV user account to a Standard account for security.

Command:

bash
Copy code
sudo dseditgroup -o edit -d "Office TV" -t user admin


Troubleshooting
If you encounter any issues with the setup:

Check Console Logs: Use the Console app to look for error messages related to the script or scheduled tasks.
Verify Permissions: Ensure that the script and configuration commands are executed with the necessary permissions.
Restart Mac: Sometimes, changes may require a system restart to take full effect.


License
This project is licensed under the MIT License - see the LICENSE file for details.

Contributing
We welcome contributions to improve this setup guide. Please open a pull request if you have suggestions or fixes.
